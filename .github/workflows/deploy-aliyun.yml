- name: SSH debug (ensure key works)
  shell: bash
  run: |
    set -euo pipefail
    mkdir -p ~/.ssh
    printf '%s' "${{ secrets.SSH_PRIVATE_KEY }}" | tr -d '\r' > ~/.ssh/id_ed25519
    chmod 600 ~/.ssh/id_ed25519
    ssh-keygen -lf ~/.ssh/id_ed25519
    ssh-keyscan -p 22 "${{ secrets.SSH_HOST }}" >> ~/.ssh/known_hosts
    ssh -i ~/.ssh/id_ed25519 -o IdentitiesOnly=yes -o PasswordAuthentication=no -p 22 \
      "${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}" "echo OK"
